"use strict";(self.webpackChunkelyra_ai_site=self.webpackChunkelyra_ai_site||[]).push([[5006],{5964:function(e,t,a){a.r(t),a.d(t,{Title:function(){return o},_frontmatter:function(){return p},default:function(){return u}});var n,i=a(3366),l=(a(7294),a(4983)),r=a(4295),s=["components"],o=function(){return(0,l.kt)("span",null,"Best practices for file-based pipeline nodes")},p={},d=(n="PageDescription",function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),(0,l.kt)("div",e)}),c={Title:o,_frontmatter:p},m=r.Z;function u(e){var t=e.components,a=(0,i.Z)(e,s);return(0,l.kt)(m,Object.assign({},c,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)(d,{mdxType:"PageDescription"},(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"pipelines.md"},"Generic pipelines and typed pipelines")," support natively file-based nodes for Jupyter notebooks, Python scripts, and R scripts. In order to support heterogeneous execution - that is making them runnable in any runtime environment (JupyterLab, Kubeflow Pipelines, and Apache Airflow) - follow the guidelines listed below.")),(0,l.kt)("h2",null,"Runtime image"),(0,l.kt)("p",null,"On Kubeflow Pipelines and Apache Airflow, notebooks and scripts are executed in containers. Elyra provides ",(0,l.kt)("a",{parentName:"p",href:"runtime-image-conf.md"},"example runtime images")," to get you started, but you should consider utilizing ",(0,l.kt)("a",{parentName:"p",href:"../recipes/creating-a-custom-runtime-image.md"},"purpose-built images")," instead. If possible, pre-install all software prerequisites in the runtime image you are using instead of installing them on the fly (e.g. by running ",(0,l.kt)("inlineCode",{parentName:"p"},"pip install my-package==1.2.3")," in a notebook cell)."),(0,l.kt)("h2",null,"File I/O"),(0,l.kt)("p",null,"In runtime environments (like Kubeflow Pipelines and Apache Airflow) where containers are used to run notebooks/scripts special consideration must be given to file input and output operations."),(0,l.kt)("h3",null,"File input"),(0,l.kt)("p",null,"If a notebook/script requires access to files that are stored on you local system, those files must be declared as ",(0,l.kt)("em",{parentName:"p"},"File dependencies"),". Elyra collects declared files and uploads them to cloud storage and makes them available to the notebook/script at runtime."),(0,l.kt)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"473px"}},"\n      ",(0,l.kt)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"32.63888888888889%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA2klEQVQoz52RSYqEQBBF8/4XcKUbRVwooqILV4KuBF0qOIMDegaHX0RAFdVNNzUkPDL4SfwYUvR9j2EYmK7rMM8zruvCcRw4z5P5L/4N5YmiKFBVFcqyRF3XaNsWy7L8gIqs68rxOI7Yto21+/s0Tayx4XMiVSf2fX/Ez/ylk3bX2TAMQ0RRhDiOkef5gyzLPiJNU9C0QpIkyLIMVVVhWRYMw4BpmvA8D77vv43rukiSBIIMbNtmHMdhM9Koc/qopml4r6+g/dMuhaIo0HWdO6Rb0zSQFgQBvjk3rOryUs+01y4AAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}}),"\n  ",(0,l.kt)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"Define file dependencies",title:"Define file dependencies",src:"/static/fbc175efe851f8cffd7f7b5f74a9ae69/739ea/vpe-node-input-files.png",srcSet:["/static/fbc175efe851f8cffd7f7b5f74a9ae69/7fc1e/vpe-node-input-files.png 288w","/static/fbc175efe851f8cffd7f7b5f74a9ae69/739ea/vpe-node-input-files.png 473w"],sizes:"(max-width: 473px) 100vw, 473px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy",decoding:"async"}),"\n    "),(0,l.kt)("p",null,"File dependencies must be located in the notebook/script file directory or a subdirectory of that location. Symlinks can be used to avoid the need to maintain multiple copies if files are shared among pipelines."),(0,l.kt)("p",null,"Valid directory layout examples:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"./my-pipeline.pipeline\n./my-notebook.ipynb\n./a-notebook-symlink.ipynb      # can reference a notebook in any local directory\n./a-dependency-file               \n./a-symlink                     # can reference any file or directory\n./a-subdir/a-dependency-file\n./a-subdir/a-symlink            # can reference any file or directory\n./a-subdir/a-script-symlink.py  # can reference a script in any local directory\n")),(0,l.kt)("p",null,"Invalid directory layout examples:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"./my-pipeline.pipeline\n./my-script.py\n../my-other-notebook.ipynb     # must be symlinked\n../a-dependency-in-parent-dir  # must be symlinked \n/some/dir/some-dependency      # must be symlinked\n")),(0,l.kt)("h3",null,"File output"),(0,l.kt)("p",null,"All changes to the file system (e.g. new files or modified files) are discarded after processing of the notebook/script has completed. To retain these files you must store those files on cloud storage, or declare those files as output files in the notebook/script node properties. "),(0,l.kt)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"542px"}},"\n      ",(0,l.kt)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"26.041666666666668%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAArUlEQVQY06WPPQqEMBCFc/872HgA8QZWFkIkgmUSRSEE/AE1Ucu3zBS7i9XCDny8vMn8MGKeZ1hr0fc9pmnCfd84z5O5rot5+hDCO08aY+Q+CrEsC4wxGIYBzjku3raN2fed/XEc7EkJ6vnOr+v6Gei9R13XaNuW0Vqj6zqM48hLCHo//VPpQrpWNE2DJEmQpimyLENRFCjLkpdIKX+Caquq4qFCKYU8zxn6+DdeT/lwEQeo5RUAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}}),"\n  ",(0,l.kt)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"Define output files",title:"Define output files",src:"/static/256490feee84e84a0b78b9c0db40fee3/3b1a6/vpe-node-output-files.png",srcSet:["/static/256490feee84e84a0b78b9c0db40fee3/7fc1e/vpe-node-output-files.png 288w","/static/256490feee84e84a0b78b9c0db40fee3/3b1a6/vpe-node-output-files.png 542w"],sizes:"(max-width: 542px) 100vw, 542px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy",decoding:"async"}),"\n    "),(0,l.kt)("h2",null,"Environment variables"),(0,l.kt)("p",null,"You can customize notebooks/scripts by setting environment variables in the pipeline node. Environment variable values are not shared across nodes belonging to the same pipeline."),(0,l.kt)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"563px"}},"\n      ",(0,l.kt)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"32.63888888888889%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/klEQVQoz53Ry6qDQAwG4Hn/d3BRF0KrqNCCWquovUD3pQiKVusVxJ0LrfIfJovDWRxo6cBHyDCEJMMejweyLMPz+aQYRRH6vsfr9cI0TWQcR/I35/G/w3ghrixL5HmOJElQ1zWapiFt26KqKsLveV4UBUVedJ7nX8uygO12O1iWRY7HI67XKy6Xy1vn85nec6fTCZ7nIY5jsNVqhfV6DUmSoOs6bNvGfr+neDgcPuI4DkzTRBiGYLIsQ1VVaJpGhYIggO/71LFhGPTwE9vtFvf7HUwQBIiiSBRFwWazIbfbjT6J7/SdNE1p3K7rwPhovCu+A851XRpjGAZ8c34AkiPntL22LbkAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}}),"\n  ",(0,l.kt)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"Define environment variables",title:"Define environment variables",src:"/static/9d814240d0de074d3d77d452cd34f0f9/e80e2/vpe-node-env-vars.png",srcSet:["/static/9d814240d0de074d3d77d452cd34f0f9/7fc1e/vpe-node-env-vars.png 288w","/static/9d814240d0de074d3d77d452cd34f0f9/e80e2/vpe-node-env-vars.png 563w"],sizes:"(max-width: 563px) 100vw, 563px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy",decoding:"async"}),"\n    "),(0,l.kt)("p",null,"The Visual Pipeline Editor can detect which environment variables notebooks/scripts are accessing and automatically adds those variables to the runtime properties if the following approaches are used to read variable values:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"Python"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"os.getenv(key[,...])")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"os.environ[key]")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"os.environ.get(key[,...])")))),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"R script"),(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"Sys.getenv(...)"))))),(0,l.kt)("p",null,"Refer to the next section for a list of proprietary environment variables that cannot be modified using the node properties settings."),(0,l.kt)("h2",null,"Proprietary environment variables"),(0,l.kt)("p",null,"Elyra makes a set of proprietary environment variables available to notebooks and scripts during execution. Unless indicated otherwise, these variables are defined in all runtime environments."),(0,l.kt)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"460px"}},"\n      ",(0,l.kt)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"28.819444444444443%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVQY052Q2W6DMBRE+f8fbJVEITZ4YTeLjQ1RTgXdXquONLpvc89MtvjEPG+4xaGGEttZurbDWktdVdR1zdI0TEIwKoWTEicEQ57Tdx0+BEIIeO9JKZH5sOH9TutaRC0oTIEqFUorlCopy5LOGJo8P4N9U7McT6qKaRyJMZ5Bx933nYwvzdNMpSustkgpT0JjDFprtLUUxvAXZWl7EuOTuEXmdSLEQIrprHF4XVf2ENimiXUcCcNA6HuCc6zO4ZflpPshdFPEuYTtK672Qq5zyqLkIR4IIXhIyaAU7fvb5263K/3lQn+74e53mqP6PP9u+I3qBoeSiv/q9Xqd/gCDjctbapT24gAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}}),"\n  ",(0,l.kt)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"Access proprietary environment variables",title:"Access proprietary environment variables",src:"/static/2127f5de807a597e95aaf8439b74c469/37e4f/elyra-env-vars.png",srcSet:["/static/2127f5de807a597e95aaf8439b74c469/7fc1e/elyra-env-vars.png 288w","/static/2127f5de807a597e95aaf8439b74c469/37e4f/elyra-env-vars.png 460w"],sizes:"(max-width: 460px) 100vw, 460px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy",decoding:"async"}),"\n    "),(0,l.kt)("h3",null,"ELYRA_RUN_NAME"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"ELYRA_RUN_NAME")," is an identifier that is unique for each pipeline run but the same for all nodes in the pipeline. You can use this identifier to generate predictable file names."),(0,l.kt)("p",null,"Example value: ",(0,l.kt)("inlineCode",{parentName:"p"},"unicorn-0617153527")),(0,l.kt)("h3",null,"ELYRA_RUNTIME_ENV"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"ELYRA_RUNTIME_ENV")," identifies the runtime environment that the\nnotebook or script is executed in:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"local")," - JupyterLab"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"kfp")," - Kubeflow Pipelines"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("inlineCode",{parentName:"li"},"airflow")," - Apache Airflow")))}u.isMDXComponent=!0},4295:function(e,t,a){a.d(t,{Z:function(){return h}});var n=a(7294),i=a(8650),l=a.n(i),r=a(5444),s=a(9403),o=a(5611),p=a(5900),d=a.n(p),c=function(e){var t,a=e.title,i=e.theme,l=e.tabs,r=void 0===l?[]:l;return n.createElement("div",{className:d()("PageHeader-module--page-header--NqfPe",(t={},t["PageHeader-module--with-tabs--vbQ-W"]=r.length,t["PageHeader-module--dark-mode--WCeH8"]="dark"===i,t))},n.createElement("div",{className:"bx--grid"},n.createElement("div",{className:"bx--row"},n.createElement("div",{className:"bx--col-lg-12"},n.createElement("h1",{id:"page-title",className:"PageHeader-module--text--Er2EO"},a)))))},m=function(e){var t=e.relativePagePath,a=e.repository,i=(0,r.useStaticQuery)("1364590287").site.siteMetadata.repository,l=a||i,s=l.baseUrl,o=l.subDirectory,p=s+"/edit/"+l.branch+o+"/src/pages"+t;return s?n.createElement("div",{className:"bx--row EditLink-module--row--BEmSX"},n.createElement("div",{className:"bx--col"},n.createElement("a",{className:"EditLink-module--link--IDrl1",href:p},"Edit this page on GitHub"))):null},u=a(4275),g=a(1721),f=function(e){function t(){return e.apply(this,arguments)||this}return(0,g.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.title,a=e.tabs,i=e.slug,s=i.split("/").filter(Boolean).slice(-1)[0],o=a.map((function(e){var t,a=l()(e,{lower:!0,strict:!0}),o=a===s,p=new RegExp(s+"/?(#.*)?$"),c=i.replace(p,a);return n.createElement("li",{key:e,className:d()((t={},t["PageTabs-module--selected-item--aBB0K"]=o,t),"PageTabs-module--list-item--024o6")},n.createElement(r.Link,{className:"PageTabs-module--link--Kz-7R",to:""+c},e))}));return n.createElement("div",{className:"PageTabs-module--tabs-container--Cdfzw"},n.createElement("div",{className:"bx--grid"},n.createElement("div",{className:"bx--row"},n.createElement("div",{className:"bx--col-lg-12 bx--col-no-gutter"},n.createElement("nav",{"aria-label":t},n.createElement("ul",{className:"PageTabs-module--list--xLqxG"},o))))))},t}(n.Component),b=f,A=a(2881),k=a(6958),y=a(36),v=function(e){var t=e.date,a=new Date(t);return t?n.createElement(y.X2,{className:"last-modified-date-module--row--XJoYQ"},n.createElement(y.sg,null,n.createElement("div",{className:"last-modified-date-module--text--ogPQF"},"Page last updated: ",a.toLocaleDateString("en-GB",{day:"2-digit",year:"numeric",month:"long"})))):null},h=function(e){var t=e.pageContext,a=e.children,i=e.location,p=e.Title,d=t.frontmatter,g=void 0===d?{}:d,f=t.relativePagePath,y=t.titleType,h=g.tabs,E=g.title,N=g.theme,w=g.description,x=g.keywords,I=g.date,R=(0,k.Z)().interiorTheme,C=(0,r.useStaticQuery)("2456312558").site.pathPrefix,P=C?i.pathname.replace(C,""):i.pathname,B=h?P.split("/").filter(Boolean).slice(-1)[0]||l()(h[0],{lower:!0}):"",T=N||R;return n.createElement(o.Z,{tabs:h,homepage:!1,theme:T,pageTitle:E,pageDescription:w,pageKeywords:x,titleType:y},n.createElement(c,{title:p?n.createElement(p,null):E,label:"label",tabs:h,theme:T}),h&&n.createElement(b,{title:E,slug:P,tabs:h,currentTab:B}),n.createElement(A.Z,{padded:!0},a,n.createElement(m,{relativePagePath:f}),n.createElement(v,{date:I})),n.createElement(u.Z,{pageContext:t,location:i,slug:P,tabs:h,currentTab:B}),n.createElement(s.Z,null))}}}]);
//# sourceMappingURL=component---src-pages-user-guide-file-based-pipeline-nodes-mdx-0d53bc65fea500e634f1.js.map