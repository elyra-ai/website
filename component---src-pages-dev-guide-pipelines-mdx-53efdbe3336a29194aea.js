"use strict";(self.webpackChunkelyra_ai_site=self.webpackChunkelyra_ai_site||[]).push([[5729],{9855:function(e,t,n){n.r(t),n.d(t,{Title:function(){return s},_frontmatter:function(){return p},default:function(){return u}});var a,i=n(3366),r=(n(7294),n(4983)),o=n(4295),l=["components"],s=function(){return(0,r.kt)("span",null,"Pipelines")},p={},c=(a="PageDescription",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.kt)("div",e)}),m={Title:s,_frontmatter:p},d=o.Z;function u(e){var t=e.components,n=(0,i.Z)(e,l);return(0,r.kt)(d,Object.assign({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)(c,{mdxType:"PageDescription"},(0,r.kt)("p",null,"The following sections cover the details relative to working with pipelines in a development capacity.")),(0,r.kt)("h2",null,"Pipeline definition"),(0,r.kt)("p",null,"Below is a json representation of the pipeline that is generated by the ",(0,r.kt)("strong",{parentName:"p"},"Pipeline Editor")," and referred to as the ",(0,r.kt)("em",{parentName:"p"},"pipeline definition"),". "),(0,r.kt)("p",null,"The pipeline is then submitted to the ",(0,r.kt)("strong",{parentName:"p"},"Elyra Scheduler")," which parses, properly packages and\nsubmits the pipeline definition to the chosen target runtime (e.g. Kubeflow Pipelines)."),(0,r.kt)("p",null,"For more details on the ",(0,r.kt)("strong",{parentName:"p"},"pipeline json definition")," see it’s ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/elyra-ai/pipeline-schemas/blob/main/common-pipeline/pipeline-flow/pipeline-flow-v3-schema.json"},"json schema")),(0,r.kt)("h3",null,"Pipeline definition json example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "doc_type": "pipeline",\n    "version": "3.0",\n    "json_schema": "http://api.dataplatform.ibm.com/schemas/common-pipeline/pipeline-flow/pipeline-flow-v3-schema.json",\n    "id": "582f2dd2-b329-4bfd-8326-3e0dc8c69744",\n    "primary_pipeline": "f757f14a-4494-46b5-bb27-aeaa8a065477",\n    "pipelines": [{\n        "id": "f757f14a-4494-46b5-bb27-aeaa8a065477",\n        "nodes": [{\n            "id": "db9f3f5b-b2e3-4824-aadd-c1c6bf652534",\n            "type": "execution_node",\n            "app_data": {\n                "label": "generate-contributions",\n                "component_parameters": {\n                    "filename": "demo-pipelines/generate-contributions.ipynb",\n                    "runtime_image": "tensorflow/tensorflow:2.0.0-py3",\n                    "outputs": ["community_contributions.csv"],\n                    "env_vars": ["GITHUB_TOKEN=xxxx"],\n                    "dependencies": ["contributors.csv"],\n                    "include_subdirectories": false\n                },\n                "ui_data": {\n                    "label": "generate-contributions",\n                    "x_pos": 387,\n                    "y_pos": 73,\n                    "description": "Notebook file"\n                }\n            },\n            "inputs": [{\n                "id": "inPort",\n                "app_data": {\n                    "ui_data": {\n                        "cardinality": {\n                            "min": 0,\n                            "max": 1\n                        },\n                        "label": "Input Port"\n                    }\n                }\n            }],\n            "outputs": [{\n                "id": "outPort",\n                "app_data": {\n                    "ui_data": {\n                        "cardinality": {\n                            "min": 0,\n                            "max": -1\n                        },\n                        "label": "Output Port"\n                    }\n                }\n            }]\n        }, {\n            "id": "f6584209-6f22-434f-9820-41327b6c749d",\n            "type": "execution_node",\n            "app_data": {\n                "label": "generate-stats",\n                "component_parameters": {\n                    "filename": "demo-pipelines/generate-stats.ipynb",\n                    "runtime_image": "tensorflow/tensorflow:2.0.0-py3",\n                    "outputs": ["community_stats.csv"],\n                    "env_vars": ["GITHUB_TOKEN=xxxx"],\n                    "dependencies": ["contributors.csv"],\n                    "include_subdirectories": false\n                },\n                "ui_data": {\n                    "label": "generate-stats",\n                    "x_pos": 77,\n                    "y_pos": 79,\n                    "description": "Notebook file"\n                }\n            },\n            "inputs": [{\n                "id": "inPort",\n                "app_data": {\n                    "ui_data": {\n                        "label": ""\n                    }\n                }\n            }],\n            "outputs": [{\n                "id": "outPort",\n                "app_data": {\n                    "ui_data": {\n                        "label": ""\n                    }\n                }\n            }]\n        }, {\n            "id": "079c0e12-eb5f-4fcc-983b-09e011869fee",\n            "type": "execution_node",\n            "app_data": {\n                "label": "overview",\n                "component_parameters": {\n                    "filename": "demo-pipelines/overview.ipynb",\n                    "runtime_image": "elyra/tensorflow:1.15.2-py3",\n                    "include_subdirectories": false\n                },\n                "ui_data": {\n                    "label": "overview",\n                    "x_pos": 318,\n                    "y_pos": 312,\n                    "description": "Notebook file"\n                }\n            },\n            "inputs": [{\n                "id": "inPort",\n                "app_data": {\n                    "ui_data": {\n                        "label": ""\n                    }\n                },\n                "links": [{\n                    "node_id_ref": "db9f3f5b-b2e3-4824-aadd-c1c6bf652534",\n                    "port_id_ref": "outPort"\n                }, {\n                    "node_id_ref": "f6584209-6f22-434f-9820-41327b6c749d",\n                    "port_id_ref": "outPort"\n                }]\n            }],\n            "outputs": [{\n                "id": "outPort",\n                "app_data": {\n                    "ui_data": {\n                        "label": ""\n                    }\n                }\n            }]\n        }],\n        "app_data": {\n            "ui_data": {\n                "comments": []\n            },\n            "title": "pipeline-title",\n            "runtime": "kfp",\n            "runtime-config": "kfp-yukked1",\n                        "version": 1\n        },\n        "runtime_ref": ""\n    }],\n    "schemas": []\n}\n')),(0,r.kt)("h2",null,"Pipeline Processor Customization"),(0,r.kt)("p",null,"Elyra implements an extensible ",(0,r.kt)("strong",{parentName:"p"},"pipeline processor engine"),", which enables the addition of new pipeline processors utilizing\na service discovery mechanism.  The pipeline processor class hierarchy is depicted here:\n",(0,r.kt)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"720px"}},"\n      ",(0,r.kt)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"56.25%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAhOAAAITgGMMQDsAAABnklEQVQoz41RzUvcQBzd/9KLxxYEq4fuSRD31otYag9+f8JiwUKh2B6k4KqLFxXdjYrGD3S3yWSSmSTuJBM2M5nfSBZl/UJ8vMPM4/14P96voJ8CADDG2LEowR5GlGDiOcR1LMuSUj4zF/QLAIBNkhuHN92cNw63SaIAXjq7w6C1AgANMoOR+ePB8Vpp4SR/fDsYnjGkzHILqI7xzWQWi1YsbJL89xIaA42UUPqt5DiRDRw3XW422JUdX9pRGIlMpNy5blMUIqvtO4I0ZIs8GgZQnSZ2au6nr/ulOWNoql6aP+ob3d04pDpCePojXeynywNkadD73hOsT+Z7K/k0OdWIacz1lZsiphDTYaozrdNUtnmcslDySPJISdFNFreE7a/x022/thkam7e7v6Pro7C20TIq7kElNLZY/R8z95iLHNOwz4+RaXgXddY8U5kqJNYpXRzwy0W//NkvF8lEb1hdIb++BOVi0FHo7IdgbcytV82/C43KD1T9ibZXg70/UqSvtP1+5IVplWmlHpjlx+wq2b0CAKBAdZh/89PdAR4NXK6xdEfBAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}}),"\n  ",(0,r.kt)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"Pipeline Processor Class Hierachy",title:"Pipeline Processor Class Hierachy",src:"/elyra-ai-site/static/8c4b746099461e9dcbd0299d6777f483/b85f6/pipeline-processor-class-hierarchy.png",srcSet:["/elyra-ai-site/static/8c4b746099461e9dcbd0299d6777f483/7fc1e/pipeline-processor-class-hierarchy.png 288w","/elyra-ai-site/static/8c4b746099461e9dcbd0299d6777f483/a5df1/pipeline-processor-class-hierarchy.png 576w","/elyra-ai-site/static/8c4b746099461e9dcbd0299d6777f483/b85f6/pipeline-processor-class-hierarchy.png 720w"],sizes:"(max-width: 720px) 100vw, 720px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy",decoding:"async"}),"\n    "),"\nThis section outlines what is needed to introduce your own runtime for integration with Elyra.  In essence, two criteria must be fulfilled to introduce a new runtime: "),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"A schema describing the necessary runtime metadata"),(0,r.kt)("li",{parentName:"ol"},"A pipeline processor implementation appropriately associated to the runtime")),(0,r.kt)("h3",null,"Custom Runtime Schema"),(0,r.kt)("p",null,"The first requirement for introducing a new runtime for use in Elyra is to define the necessary metadata corresponding to the runtime.  This is accomplished via a JSON schema file describing the necessary metadata used to integrate with the targeted runtime platform."),(0,r.kt)("p",null,"This file must reside in the ",(0,r.kt)("inlineCode",{parentName:"p"},"elyra/metadata/schemas")," directory in which Elyra has been installed.  (This location will change to better accommodate custom runtimes in the future.)"),(0,r.kt)("p",null,"The schema name, represented by the value of the top-level ",(0,r.kt)("inlineCode",{parentName:"p"},"name")," property or, if absent, the file’s basename, is what the pipeline engine uses to locate the appropriate pipeline processor implementation.  This value is also set into the pipeline definition’s ",(0,r.kt)("inlineCode",{parentName:"p"},"runtime")," property in Elyra’s UI, thereby tying the pipeline to the appropriate processor."),(0,r.kt)("p",null,"The schema should minimally include property definitions for the Cloud Object Storage (cos) properties found in the built-in schema definitions for ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/elyra-ai/elyra/blob/62e1964244ec8ada3e63c9c6d39befd7c046df08/elyra/metadata/schemas/kfp.json#L83-L129"},"Kubeflow Pipelines")," and ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/elyra-ai/elyra/blob/62e1964244ec8ada3e63c9c6d39befd7c046df08/elyra/metadata/schemas/airflow.json#L93-L139"},"Apache Airflow"),"."),(0,r.kt)("h3",null,"Custom Runtime Pipeline Processor Implementation"),(0,r.kt)("p",null,"The pipeline processor implementation that corresponds to the targeted runtime platform must be a subclass of ",(0,r.kt)("inlineCode",{parentName:"p"},"elyra.pipeline.processor.RuntimePipelineProcessor")," - which, itself, derives from ",(0,r.kt)("inlineCode",{parentName:"p"},"elyra.pipeline.processor.PipelineProcessor"),"."),(0,r.kt)("p",null,"To facilitate discovery by the pipeline engine, this implementation must use a value for its ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/elyra-ai/elyra/blob/62e1964244ec8ada3e63c9c6d39befd7c046df08/elyra/pipeline/processor.py#L156"},(0,r.kt)("inlineCode",{parentName:"a"},"type")," property")," identical to its schema name."),(0,r.kt)("h4",null,"Processor Registration"),(0,r.kt)("p",null,"The pipeline processor should be registered using ",(0,r.kt)("strong",{parentName:"p"},"entry_points")," with a ",(0,r.kt)("em",{parentName:"p"},"name")," that matches both the schema name corresponding to the new runtime and the pipeline processor’s ",(0,r.kt)("inlineCode",{parentName:"p"},"type")," property value.  Although this is not technically required, we would like to possibly utilize this during discovery in the future (and is true relative to the built-in processors)."),(0,r.kt)("p",null,"Entrypoint definitions are typically found in the package’s ",(0,r.kt)("strong",{parentName:"p"},"setup.py")," or ",(0,r.kt)("strong",{parentName:"p"},"setup.cfg")," files similar to the following example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},"    entry_points = {\n        'elyra.pipeline.processors': [\n            'my_runtime = acme.my_runtime:MyRuntimePipelineProcessor'\n        ]\n    },\n")),(0,r.kt)("p",null,"In this example, and corresponding to the criteria above, pipeline processor ",(0,r.kt)("inlineCode",{parentName:"p"},"acme.my_runtime.MyRuntimePipelineProcessor")," will:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"derive from ",(0,r.kt)("inlineCode",{parentName:"li"},"elyra.pipeline.processor.RuntimePipelineProcessor")),(0,r.kt)("li",{parentName:"ul"},"use a value of ",(0,r.kt)("inlineCode",{parentName:"li"},"my_runtime")," for its ",(0,r.kt)("inlineCode",{parentName:"li"},"type")," property value"),(0,r.kt)("li",{parentName:"ul"},"place a ",(0,r.kt)("inlineCode",{parentName:"li"},"my_runtime.json")," schema file into Elyra’s installation’s ",(0,r.kt)("inlineCode",{parentName:"li"},"metadata/schemas")," directory")))}u.isMDXComponent=!0},4295:function(e,t,n){n.d(t,{Z:function(){return v}});var a=n(7294),i=n(8650),r=n.n(i),o=n(5444),l=n(9403),s=n(5611),p=n(5900),c=n.n(p),m=function(e){var t,n=e.title,i=e.theme,r=e.tabs,o=void 0===r?[]:r;return a.createElement("div",{className:c()("PageHeader-module--page-header--NqfPe",(t={},t["PageHeader-module--with-tabs--vbQ-W"]=o.length,t["PageHeader-module--dark-mode--WCeH8"]="dark"===i,t))},a.createElement("div",{className:"bx--grid"},a.createElement("div",{className:"bx--row"},a.createElement("div",{className:"bx--col-lg-12"},a.createElement("h1",{id:"page-title",className:"PageHeader-module--text--Er2EO"},n)))))},d=function(e){var t=e.relativePagePath,n=e.repository,i=(0,o.useStaticQuery)("1364590287").site.siteMetadata.repository,r=n||i,l=r.baseUrl,s=r.subDirectory,p=l+"/edit/"+r.branch+s+"/src/pages"+t;return l?a.createElement("div",{className:"bx--row EditLink-module--row--BEmSX"},a.createElement("div",{className:"bx--col"},a.createElement("a",{className:"EditLink-module--link--IDrl1",href:p},"Edit this page on GitHub"))):null},u=n(4275),h=n(1721),b=function(e){function t(){return e.apply(this,arguments)||this}return(0,h.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.title,n=e.tabs,i=e.slug,l=i.split("/").filter(Boolean).slice(-1)[0],s=n.map((function(e){var t,n=r()(e,{lower:!0,strict:!0}),s=n===l,p=new RegExp(l+"/?(#.*)?$"),m=i.replace(p,n);return a.createElement("li",{key:e,className:c()((t={},t["PageTabs-module--selected-item--aBB0K"]=s,t),"PageTabs-module--list-item--024o6")},a.createElement(o.Link,{className:"PageTabs-module--link--Kz-7R",to:""+m},e))}));return a.createElement("div",{className:"PageTabs-module--tabs-container--Cdfzw"},a.createElement("div",{className:"bx--grid"},a.createElement("div",{className:"bx--row"},a.createElement("div",{className:"bx--col-lg-12 bx--col-no-gutter"},a.createElement("nav",{"aria-label":t},a.createElement("ul",{className:"PageTabs-module--list--xLqxG"},s))))))},t}(a.Component),f=b,g=n(2881),y=n(6958),k=n(36),N=function(e){var t=e.date,n=new Date(t);return t?a.createElement(k.X2,{className:"last-modified-date-module--row--XJoYQ"},a.createElement(k.sg,null,a.createElement("div",{className:"last-modified-date-module--text--ogPQF"},"Page last updated: ",n.toLocaleDateString("en-GB",{day:"2-digit",year:"numeric",month:"long"})))):null},v=function(e){var t=e.pageContext,n=e.children,i=e.location,p=e.Title,c=t.frontmatter,h=void 0===c?{}:c,b=t.relativePagePath,k=t.titleType,v=h.tabs,w=h.title,_=h.theme,P=h.description,E=h.keywords,x=h.date,A=(0,y.Z)().interiorTheme,T=(0,o.useStaticQuery)("2456312558").site.pathPrefix,C=T?i.pathname.replace(T,""):i.pathname,I=v?C.split("/").filter(Boolean).slice(-1)[0]||r()(v[0],{lower:!0}):"",D=_||A;return a.createElement(s.Z,{tabs:v,homepage:!1,theme:D,pageTitle:w,pageDescription:P,pageKeywords:E,titleType:k},a.createElement(m,{title:p?a.createElement(p,null):w,label:"label",tabs:v,theme:D}),v&&a.createElement(f,{title:w,slug:C,tabs:v,currentTab:I}),a.createElement(g.Z,{padded:!0},n,a.createElement(d,{relativePagePath:b}),a.createElement(N,{date:x})),a.createElement(u.Z,{pageContext:t,location:i,slug:C,tabs:v,currentTab:I}),a.createElement(l.Z,null))}}}]);
//# sourceMappingURL=component---src-pages-dev-guide-pipelines-mdx-53efdbe3336a29194aea.js.map